{"version":3,"sources":["xslet.window.js"],"names":["xslet","defineUnitOfSize","nsWindow","getUnitOfSize","unitOfSize","setUnitOfSize","unit","Error","Object","defineProperty","enumerable","get","set","defineRootFontSize","htmlTag","computedHtmlStyle","getRootFontSize","parseInt","fontSize","slice","setRootFontSize","replace","num","length","style","getPxPerMm","window","divTag","document","createElement","position","visibility","body","appendChild","computedStyle","getComputedStyle","fontSizePx","parentNode","removeChild","Number","defineConvertUnit","convertUnit","value","fromUnit","toUnit","pxPerMm","pxPerRem","rootFontSize","defineWindow","getElementsByTagName"],"mappings":";;;;AAWAA,MAAA,mBAAAA,UAAAA,MAEA,WACA,YAUA,SAAAC,GAAAC,GAGA,QAAAC,KACA,MAAAC,KAAAA,EAAA,MAGA,QAAAC,GAAAC,GACA,GAAA,OAAAA,GAAA,OAAAA,GAAA,QAAAA,EACA,KAAA,IAAAC,OAAA,iDAAAD,EAGAF,KACAA,EAAAE,GAZA,GAAAF,EAgBAI,QAAAC,eAAAP,EAAA,cACAQ,YAAA,EACAC,IAAAR,EACAS,IAAAP,IAcA,QAAAQ,GAAAX,EAAAY,EAAAC,GAEA,QAAAC,KACA,MAAAC,UAAAF,EAAAG,SAAAC,MAAA,GAAA,IAGA,QAAAC,GAAAF,GACA,GAAA,gBAAAA,GAAA,CACA,GAAAA,GAAA,EACA,KAAA,IAAAX,OAAA,6CACAW,EAEAA,IAAA,SAEA,CAAA,GAAA,gBAAAA,GAcA,KAAA,IAAAX,OAAA,oCAAAW,EAbA,IAAAZ,GAAAY,EAAAG,QAAA,UAAA,GACA,IAAA,OAAAf,GAAA,OAAAA,EACA,KAAA,IAAAC,OAAA,4DACAW,EAGA,IAAAI,GAAAL,SAAAC,EAAAC,MAAA,GAAAb,EAAAiB,QACA,KAAAD,EACA,KAAA,IAAAf,OAAA,6CACAW,GAOAJ,EAAAU,MAAAN,SAAAA,EAGAV,OAAAC,eAAAP,EAAA,gBACAQ,YAAA,EACAC,IAAAK,EACAJ,IAAAQ,IAYA,QAAAK,GAAAC,GACA,GAAAC,GAAAD,EAAAE,SAAAC,cAAA,MACAF,GAAAH,MAAAN,SAAA,QACAS,EAAAH,MAAAM,SAAA,WACAH,EAAAH,MAAAO,WAAA,SACAL,EAAAE,SAAAI,KAAAC,YAAAN,EAEA,IAAAO,GAAAR,EAAAS,iBAAAR,GACAS,EAAAF,EAAAhB,QAEA,OADAS,GAAAU,WAAAC,YAAAX,GACAY,OAAAH,EAAAjB,MAAA,GAAA,KAAAI,SAAA,IAYA,QAAAiB,GAAAtC,EAAAwB,GAGA,QAAAe,GAAAC,EAAAC,EAAAC,GACAC,EAAAA,GAAApB,EAAAC,EACA,IAAAoB,GAAA5C,EAAA6C,YAEA,IAAA,OAAAJ,EAAA,CACA,GAAA,OAAAC,EACA,MAAAF,GAAAG,CAGA,IAAA,QAAAD,EACA,MAAAF,GAAAI,MAGA,IAAA,OAAAH,EAAA,CACA,GAAA,OAAAC,EACA,MAAAF,GAAAG,CAGA,IAAA,QAAAD,EACA,MAAAF,GAAAG,EAAAC,MAGA,IAAA,QAAAH,EAAA,CACA,GAAA,OAAAC,EACA,MAAAF,GAAAI,CAGA,IAAA,OAAAF,EACA,MAAAF,GAAAI,EAAAD,EAIA,KAAA,IAAAtC,OAAA,oBAAAoC,EAAA,SAAAC,EAAA,KAlCA,GAAAC,EAqCArC,QAAAC,eAAAP,EAAA,eACAQ,YAAA,EACAgC,MAAAD,IAYA,QAAAO,GAAAhD,EAAA0B,GACA,GAAAZ,GAAAY,EAAAE,SAAAqB,qBAAA,QAAA,GACAlC,EAAAW,EAAAS,iBAAArB,EAYAN,QAAAC,eAAAT,EAAA,UACAU,YAAA,EACAgC,WAGAzC,EAAAD,EAAA0B,QACAb,EAAAb,EAAA0B,OAAAZ,EAAAC,GAaAyB,EAAAxC,EAAA0B,OAAAA,GAvMAsB,EAAAhD,MAAA0B","file":"xslet.window.min.js","sourcesContent":["/*!\n * Copyright (C) 2016 xslet project.\n * This software is released under the MIT license.\n */\n\n/**\n * Is the top namespace of all xslet modules.\n *\n * @namespace xslet\n * @global\n */\n;xslet = (typeof xslet === 'undefined') ? {} : xslet;\n\n(function(){\n  'use strict';\n  defineWindow(xslet, window);\n\n\n/**\n * Defines a unit of a whole of HTML page as a property of `xslet.window`\n * namespace.\n *\n * @param nsWindow {object} - `xslet.window` namespace object.\n */\nfunction defineUnitOfSize(nsWindow) {\n  var unitOfSize;\n\n  function getUnitOfSize() {\n    return unitOfSize || (unitOfSize = 'px');\n  }\n\n  function setUnitOfSize(unit) {\n    if (unit !== 'px' && unit !== 'mm' && unit !== 'rem') {\n      throw new Error('The unit must be either \"px\", \"mm\" or \"rem\" : ' + unit);\n    }\n\n    if (!unitOfSize) {\n      unitOfSize = unit;\n    }\n  }\n\n  Object.defineProperty(nsWindow, 'unitOfSize', {\n    enumerable: true,\n    get: getUnitOfSize,\n    set: setUnitOfSize,\n  });\n}\n\n\n/**\n * Defines the root font size as a property of `xslet.window` namespace.\n *\n * @private\n * @param nsWindow {object} - `xslet.window` namespace object.\n * @param htmlTag {HTMLElement} - A HTML element of DOM.\n * @param computedHtmlStyle {CSS2Properties} - A computed style object of\n *  `htmlTag`.\n */\nfunction defineRootFontSize(nsWindow, htmlTag, computedHtmlStyle) {\n\n  function getRootFontSize() {\n    return parseInt(computedHtmlStyle.fontSize.slice(0, -2));\n  }\n\n  function setRootFontSize(fontSize) {\n    if (typeof fontSize === 'number') {\n      if (fontSize <= 0) {\n        throw new Error('The font size must be a positive number : ' +\n          fontSize);\n      }\n      fontSize = fontSize + 'px';\n\n    } else if (typeof fontSize === 'string') {\n      var unit = fontSize.replace(/^[0-9]+/, '');\n      if (unit !== 'px' && unit !== 'mm') {\n        throw new Error('The unit of root font size must be either ' +\n          '\"px\" or \"mm\" : ' + fontSize);\n      }\n\n      var num = parseInt(fontSize.slice(0, -unit.length));\n      if (!num) {\n        throw new Error('The font size must be a positive number : ' +\n          fontSize);\n      }\n\n    } else {\n      throw new Error('The font size must be a number : ' + fontSize);\n    }\n\n    htmlTag.style.fontSize = fontSize;\n  }\n\n  Object.defineProperty(nsWindow, 'rootFontSize', {\n    enumerable: true,\n    get: getRootFontSize,\n    set: setRootFontSize,\n  });\n}\n\n\n/**\n * Gets pixel count per millimeter.\n *\n * @private\n * @param window {Window} - A window object of DOM.\n * @return {number} - Pixel count per millimeter.\n */\nfunction getPxPerMm(window) {\n  var divTag = window.document.createElement('div');\n  divTag.style.fontSize = '100mm';\n  divTag.style.position = 'absolute';\n  divTag.style.visibility = 'hidden';\n  window.document.body.appendChild(divTag);\n\n  var computedStyle = window.getComputedStyle(divTag);\n  var fontSizePx = computedStyle.fontSize;\n  divTag.parentNode.removeChild(divTag);\n  return Number(fontSizePx.slice(0, -'px'.length)) / 100;\n}\n\n/**\n * Defines a function to convert a size value in a unit to new value in\n * another unit.\n * The units supported by this function are `'px'`, `'mm'` and `'rem'`.\n *\n * @private\n * @param nsWindow {object} - The `xslet.window` namespace object.\n * @param window {Window} - The window object of DOM.\n */\nfunction defineConvertUnit(nsWindow, window) {\n  var pxPerMm;\n\n  function convertUnit(value, fromUnit, toUnit) {\n    pxPerMm = pxPerMm || getPxPerMm(window);\n    var pxPerRem = nsWindow.rootFontSize;\n\n    if (fromUnit === 'px') {\n      if (toUnit === 'mm') {\n        return value / pxPerMm;\n      }\n\n      if (toUnit === 'rem') {\n        return value / pxPerRem;\n      }\n\n    } else if (fromUnit === 'mm') {\n      if (toUnit === 'px') {\n        return value * pxPerMm;\n      }\n\n      if (toUnit === 'rem') {\n        return (value * pxPerMm) / pxPerRem;\n      }\n\n    } else if (fromUnit === 'rem') {\n      if (toUnit === 'px') {\n        return value * pxPerRem;\n      }\n\n      if (toUnit === 'mm') {\n        return (value * pxPerRem) / pxPerMm;\n      }\n    }\n\n    throw new Error('Illegal units : \"' + fromUnit + '\" -> \"' + toUnit + '\"');\n  }\n\n  Object.defineProperty(nsWindow, 'convertUnit', {\n    enumerable: true,\n    value: convertUnit,\n  });\n}\n\n\n/**\n * Defines `xslet.window` namespace.\n *\n * @private\n * @param xslet {object} - `xslet` namespace object.\n * @param window {Window} - A window object of DOM.\n */\nfunction defineWindow(xslet, window) {\n  var htmlTag = window.document.getElementsByTagName('html')[0];\n  var computedHtmlStyle = window.getComputedStyle(htmlTag);\n\n  /**\n   * Is the namespace for window informations and operations.\n   *\n   * @namespace xslet.window\n   * @prop unitOfSize {string} - The unit of size used in a whole of HTML page.\n   * @prop rootFontSize {number} - The root font size.\n   *   This value is a number, and can be specified as a number or a string\n   *   of which format is `value + unit`.\n   *   The unit allowed is either `'px'`, `'mm'` or `'rem'`.\n   */\n  Object.defineProperty(xslet, 'window', {\n    enumerable: true,\n    value: {},\n  });\n\n  defineUnitOfSize(xslet.window);\n  defineRootFontSize(xslet.window, htmlTag, computedHtmlStyle);\n\n  /**\n   * Converts `value` in `fromUnit` to new value in `toUnit`.\n   * The units allowed are either `'px'`, `'mm'` and `'rem'`.\n   *\n   * @param value {number} - A value to be converted.\n   * @param fromUnit {string} - The unit of `value`.\n   * @param toUnit {string} - The unit of value after converted.\n   * @return {number} The value after converted.\n   * @memberof xslet.window\n   * @method xslet.window.convertUnit\n   */\n  defineConvertUnit(xslet.window, window);\n}\n\n}());\n"]}